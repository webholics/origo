<?xml version="1.0" encoding="utf-8"?>
<mx:Application 
	xmlns:mx="http://www.adobe.com/2006/mxml" 
	xmlns:origo="com.origo.*"
	preloader="com.origo.Preloader"
	creationComplete="init();"
	layout="absolute"
	minWidth="0"
	minHeight="0">
	
	<mx:Style source="../assets/style.css" />
	<mx:Script>		
		<![CDATA[
			import com.origo.*;
			import mx.controls.Alert;
			
			// the editor
			[Bindable]
			public var editor:Editor;

			private function init():void
			{
				// set api base url
				var api:ApiConnector = ApiConnector.getInstance();
				api.setApiUrl(parameters["api_url"]);
				
				// init editor
				editor = new Editor();
				
				// switch to login state
				currentState = "login";
				
				// set global alert button width
				Alert.buttonWidth = 100;
   			}
		]]>
	</mx:Script>
	
	<mx:states>
		<mx:State name="login">
			<mx:AddChild>
				<origo:LoginBox id="loginBox"/>
			</mx:AddChild>		
		</mx:State>
		<mx:State name="dashboard">
			<mx:AddChild>
				<origo:Header id="header" left="10" right="10" minWidth="900"/>
			</mx:AddChild>
			<mx:AddChild>
				<mx:Canvas id="mainContainer" left="10" right="10" top="{header.y + header.height + 10}" bottom="10" minWidth="900"  minHeight="400">
					<origo:Dashboard id="dashboard" width="100%"/>			
				</mx:Canvas>
			</mx:AddChild>
		</mx:State>
		<mx:State name="editor" basedOn="dashboard">
			<mx:RemoveChild target="{dashboard}"/>
			<mx:AddChild target="{editor}" relativeTo="{mainContainer}" position="lastChild"/>
		</mx:State>
		<mx:State name="browser" basedOn="dashboard">
			<mx:RemoveChild target="{dashboard}"/>
		</mx:State>
		<mx:State name="about" basedOn="dashboard">
			<mx:RemoveChild target="{dashboard}"/>
			<mx:AddChild relativeTo="{mainContainer}" position="lastChild">
				<origo:AboutBox id="aboutBox"/>
			</mx:AddChild>
		</mx:State>
	</mx:states>
	
	<mx:transitions>
		<mx:Transition fromState="" toState="login">
			<mx:Fade target="{loginBox}" duration="500" alphaFrom="0" alphaTo="1"/>
		</mx:Transition>
		<mx:Transition fromState="*" toState="dashboard">
			<mx:Fade target="{dashboard}" duration="500" alphaFrom="0" alphaTo="1"/>
		</mx:Transition>
		<mx:Transition fromState="*" toState="editor">
			<mx:Fade target="{editor}" duration="500" alphaFrom="0" alphaTo="1"/>
		</mx:Transition>
		<mx:Transition fromState="*" toState="about">
			<mx:Fade target="{aboutBox}" duration="500" alphaFrom="0" alphaTo="1"/>
		</mx:Transition>
	</mx:transitions>

</mx:Application>
